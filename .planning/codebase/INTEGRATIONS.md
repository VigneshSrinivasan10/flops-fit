# External Integrations

**Analysis Date:** 2026-02-15

## APIs & External Services

**HuggingFace Hub (Dataset & Model Downloads):**
- TinyStories dataset - Primary training dataset for scaling experiments
  - Dataset ID: `roneneldan/TinyStories` (referenced in `src/flops_fit/conf/trainer.yaml`)
  - SDK/Client: `datasets` library (HuggingFace)
  - Auth: None required for public datasets; `HF_TOKEN` env var if private datasets needed
  - Local cache: `.cache/datasets/`
- GPT-2 Tokenizer - Tokenizer for text preprocessing
  - Tokenizer ID: `gpt2` (referenced in `src/flops_fit/conf/trainer.yaml`)
  - SDK/Client: `transformers` library (HuggingFace)
  - Auth: None required

**External Training API (Optional/Stub):**
- Generic external training API - Referenced as `mode=api` in `src/flops_fit/trainer.py`
  - Status: Not implemented; `TrainingRunner._train_fn` is `None` when mode is "api"
  - Integration point: `src/flops_fit/trainer.py` line 100 (`if mode == "mock": self._train_fn = self._mock_train`)
  - Auth: Not defined

## Data Storage

**Databases:**
- None - No database used

**File Storage (Local Filesystem Only):**
- `outputs/sweep.json` - Experiment sweep configurations generated by planner
- `outputs/results.json` - Training results written incrementally by trainer
- `outputs/analysis/scaling_laws.json` - Fitted power law coefficients from analyzer
- `outputs/plots/` - PNG plots generated by visualizer (`isoflops_curves.png`, `scaling_laws.png`, `tokens_per_param.png`)
- `outputs/checkpoints/` - Model checkpoints directory (configured but not implemented in mock mode)
- `outputs/logs/` - Log files directory (configured in `trainer.yaml`)
- `.cache/datasets/` - HuggingFace dataset cache (tokenized datasets)

All `outputs/` and `.cache/` paths are gitignored.

**Caching:**
- HuggingFace datasets cache: `.cache/datasets/` (controlled by `cache_dir` in `trainer.yaml`)
- No in-memory or external cache service

## Authentication & Identity

**Auth Provider:**
- None - No authentication system
- HuggingFace Hub: uses public API; no credentials required for default TinyStories dataset

## Monitoring & Observability

**Error Tracking:**
- None - No external error tracking service

**Logs:**
- Python `logging` module (stdlib) used across all modules
- Logger instances: `logger = logging.getLogger(__name__)` in each module
- Hydra manages log output; log directory configured as `outputs/logs/` in `trainer.yaml`
- Log level: standard Python logging; Hydra sets up handlers automatically

## CI/CD & Deployment

**Hosting:**
- None - Local research tool, no deployment target

**CI Pipeline:**
- None detected - No `.github/`, no CI config files present

## Environment Configuration

**Required env vars:**
- None required for mock mode (default)
- Optional: `HF_TOKEN` - Only needed if using private HuggingFace datasets

**Secrets location:**
- No secrets management; `.env` files not used
- `.gitignore` includes standard Python secret patterns

## Webhooks & Callbacks

**Incoming:**
- None

**Outgoing:**
- None

## PyTorch Backend Notes

The model (`src/flops_fit/model.py`) uses PyTorch 2.0+ `F.scaled_dot_product_attention` when available, with a manual fallback for older versions. The hardware target is CPU (AMD Ryzen 7 5825U), though CUDA is supported via `hardware.device: cpu` config override in `src/flops_fit/conf/trainer.yaml`.

---

*Integration audit: 2026-02-15*
